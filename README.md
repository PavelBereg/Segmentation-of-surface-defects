Понял, проблема в форматировании. GitHub использует синтаксис Markdown, и чтобы все отображалось красиво, нужно строго ему следовать. Иногда при копировании могут возникать проблемы.

Давайте я предоставлю вам код, который вы можете скопировать "как есть" (в режиме "raw" или "как простой текст"), и он точно будет выглядеть правильно на GitHub. Я уберу все лишние HTML-теги и оставлю только чистый Markdown.

Финальный код для README.md (чистый Markdown)
# Система семантической сегментации промышленных дефектов

Проект представляет собой реализацию системы для автоматического контроля качества в промышленности. Модель на основе глубокого обучения способна находить и попиксельно выделять дефекты на изображениях различных материалов.

Работа выполнена в рамках выпускной квалификационной работы.


*Пример работы модели на категории 'carpet'. Замените эту ссылку на скриншот с вашим результатом.*

## Ключевые особенности

- **Архитектура:** U-Net с предобученными бэкбонами (например, `EfficientNet-B0` или `ResNet50`) из библиотеки `segmentation-models-pytorch`.
- **Data-Centric подход:** Для решения проблемы отсутствия дефектов в обучающей выборке датасета MVTec AD, применена стратегия формирования обучающей выборки из части тестовых данных.
- **Борьба с переобучением:** Реализован комплексный подход, включающий:
  - Интенсивную аугментацию данных с помощью `Albumentations`.
  - Двухэтапную fine-tuning стратегию (сначала "голова", затем вся модель).
  - L2-регуляризацию (Weight Decay) и планировщик скорости обучения.
- **Гибкость:** Скрипты для обучения и тестирования являются универсальными и могут работать с любой из 15 категорий датасета.

## Структура проекта


BKR_defect_detection/
├── data/ # Датасет MVTec AD
├── results/ # Папка для сохранения результатов тестирования
├── src/ # Исходный код
│ ├── config.py # Глобальные настройки
│ ├── dataset.py # Класс для загрузки данных
│ ├── model_setup.py # Создание модели и аугментаций
│ ├── train.py # Скрипт для интерактивного обучения
│ ├── full_evaluate.py # Скрипт для визуальной оценки
│ └── calculate_metrics.py # Скрипт для расчета метрик
└── requirements.txt # Зависимости проекта

## Быстрый старт

### 1. Клонирование и установка

```bash
git clone https://github.com/ВАШ_ЛОГИН/ВАШ_РЕПОЗИТОРИЙ.git
cd ВАШ_РЕПОЗИТОРИЙ
pip install -r requirements.txt
IGNORE_WHEN_COPYING_START
content_copy
download
Use code with caution.
IGNORE_WHEN_COPYING_END
2. Подготовка данных

Скачайте датасет MVTec Anomaly Detection.

Распакуйте архив так, чтобы папки с категориями (bottle, carpet и т.д.) находились внутри директории data/.

3. Обучение модели

Запустите интерактивный скрипт из корневой папки проекта:

python src/train.py
IGNORE_WHEN_COPYING_START
content_copy
download
Use code with caution.
Bash
IGNORE_WHEN_COPYING_END

Далее в консоли появится меню для выбора категории (или нескольких) для обучения. Обученная модель будет сохранена в корневую директорию проекта (например, best_model_carpet.pth).

4. Тестирование и оценка

После обучения модели для нужной категории, запустите скрипты для оценки.

Визуальная оценка:

# Пример для категории 'carpet'
python src/full_evaluate.py --category carpet
IGNORE_WHEN_COPYING_START
content_copy
download
Use code with caution.
Bash
IGNORE_WHEN_COPYING_END

Изображения с результатами будут сохранены в папку results/carpet/.

Количественная оценка (расчет метрик):

# Пример для категории 'carpet'
python src/calculate_metrics.py --category carpet
IGNORE_WHEN_COPYING_START
content_copy
download
Use code with caution.
Bash
IGNORE_WHEN_COPYING_END

Результаты (средний IoU) будут выведены в консоль.

---

### Как правильно скопировать и вставить

1.  **Нажмите кнопку "Copy"** или "Скопировать" в углу этого блока с кодом, чтобы скопировать чистый текст.
2.  Перейдите на GitHub в ваш репозиторий.
3.  Нажмите на кнопку "Add file" -> "Create new file".
4.  Назовите файл `README.md`.
5.  **Вставьте скопированный текст** в поле для редактирования.
6.  **Замените `ВАШ_ЛОГИН/ВАШ_РЕПОЗИТОРИЙ`** на реальные данные.
7.  **(Опционально)** Замените ссылку `https://i.imgur.com/your_image_link.png` на вашу собственную, как я описывал ранее.
8.  Нажмите "Commit new file".

Теперь все должно отображаться идеально: с заголовками, списками, блоками кода и картинкой.
IGNORE_WHEN_COPYING_START
content_copy
download
Use code with caution.
IGNORE_WHEN_COPYING_END
