# Система семантической сегментации промышленных дефектов

Проект представляет собой реализацию системы для автоматического контроля качества в промышленности. Модель на основе глубокого обучения способна находить и попиксельно выделять дефекты на изображениях различных материалов.

Работа выполнена в рамках выпускной квалификационной работы.



## Ключевые особенности

- **Архитектура:** U-Net с предобученными бэкбонами (EfficientNet, ResNet) из библиотеки `segmentation-models-pytorch`.
- **Data-Centric подход:** Для решения проблемы отсутствия дефектов в обучающей выборке датасета MVTec AD, была применена стратегия формирования обучающей выборки из части тестовых данных.
- **Борьба с переобучением:** Реализован комплексный подход, включающий:
  - Интенсивную аугментацию данных с помощью `Albumentations`.
  - Двухэтапную fine-tuning стратегию (сначала "голова", затем вся модель).
  - L2-регуляризацию (Weight Decay) и планировщик скорости обучения.
- **Гибкость:** Скрипты для обучения и тестирования являются универсальными и могут работать с любой из 15 категорий датасета.

## Структура проекта


BKR_defect_detection/
├── data/ # Датасет MVTec AD
├── results/ # Папка для сохранения результатов тестирования
├── src/ # Исходный код
│ ├── config.py # Глобальные настройки
│ ├── dataset.py # Класс для загрузки данных
│ ├── train.py # Скрипт для интерактивного обучения
│ ├── full_evaluate.py # Скрипт для визуальной оценки
│ └── calculate_metrics.py # Скрипт для расчета метрик
└── requirements.txt # Зависимости проекта

## Быстрый старт

### 1. Клонирование и установка

```bash
git clone https://github.com/ВАШ_ЛОГИН/ВАШ_РЕПОЗИТОРИЙ.git
cd ВАШ_РЕПОЗИТОРИЙ
pip install -r requirements.txt
IGNORE_WHEN_COPYING_START
content_copy
download
Use code with caution.
IGNORE_WHEN_COPYING_END
2. Подготовка данных

Скачайте датасет MVTec Anomaly Detection.

Распакуйте архив так, чтобы папки с категориями (bottle, carpet и т.д.) находились внутри директории data/.

3. Обучение модели

Запустите интерактивный скрипт из корневой папки проекта:

python src/train.py
IGNORE_WHEN_COPYING_START
content_copy
download
Use code with caution.
Bash
IGNORE_WHEN_COPYING_END

Далее в консоли появится меню для выбора категории (или нескольких) для обучения. Обученная модель будет сохранена в корневую директорию проекта (например, best_model_carpet.pth).

4. Тестирование и оценка

После обучения модели для нужной категории, запустите скрипты для оценки.

Визуальная оценка:

# Пример для категории 'carpet'
python src/full_evaluate.py --category carpet
IGNORE_WHEN_COPYING_START
content_copy
download
Use code with caution.
Bash
IGNORE_WHEN_COPYING_END

Изображения с результатами будут сохранены в папку results/carpet/.

Количественная оценка (расчет метрик):

# Пример для категории 'carpet'
python src/calculate_metrics.py --category carpet
IGNORE_WHEN_COPYING_START
content_copy
download
Use code with caution.
Bash
IGNORE_WHEN_COPYING_END

Результаты (средний IoU) будут выведены в консоль.

---

### Инструкция по использованию этого README:

1.  **Скопируйте весь текст** выше, начиная с `# Система семантической сегментации...`.
2.  **Создайте** в корне вашего проекта файл с названием `README.md`.
3.  **Вставьте** скопированный текст в этот файл.
4.  **Замените `ВАШ_ЛОГИН/ВАШ_РЕПОЗИТОРИЙ`** на актуальный путь к вашему репозиторию на GitHub.
5.  **(Рекомендуется)** Сделайте скриншот с результатом работы `full_evaluate.py`, загрузите его на [Imgur](https://imgur.com/) или любой другой хостинг, скопируйте прямую ссылку на изображение (`.png` или `.jpg`) и замените ею ссылку `https://i.imgur.com/example.png`.

После этого ваш репозиторий будет выглядеть профессионально и понятно для любого, кто его посетит.
IGNORE_WHEN_COPYING_START
content_copy
download
Use code with caution.
IGNORE_WHEN_COPYING_END
